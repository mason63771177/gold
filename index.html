<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è£‚é‡‘7æ—¥ H5 é¡µé¢</title>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-K7WCTWLM');</script>
  <!-- End Google Tag Manager -->
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QQ6GQ79K7G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-QQ6GQ79K7G');
  </script>
  
  <link rel="stylesheet" href="themes.css">
  <link rel="stylesheet" href="css/global-background.css">
  <script src="theme-switcher.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
        "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 16px;
      overflow: hidden;
    }

    /* åº”ç”¨å®¹å™¨ 100vh ä¸‰æ®µå¼å¸ƒå±€ */
    .app {
      height: 100vh;
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 1;
    }



    /* é¡¶éƒ¨åŒºåŸŸ - å›ºå®šé«˜åº¦ */
    .header {
      flex: 0 0 70px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      padding-top: 4px;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-color);
      z-index: 100;
    }
    
    .header-main {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 0;
    }
    
    .status-info {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .logo {
      font-size: 32px;
      font-weight: 700;
      letter-spacing: 1px;
      background: var(--btn-gradient);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      filter: var(--logo-filter);
    }

    /* æ–°çš„ logo å›¾ç‰‡æ ·å¼ - é€‚ä¸­å°ºå¯¸ */
    .logo-img {
      width: 65px;
      height: 65px;
      object-fit: contain;
      filter: var(--logo-filter);
    }
    .state-label {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-secondary);
      text-shadow: 0 0 6px var(--accent-color);
    }
    .subtitle {
      font-size: 12px;
      color: var(--text-secondary);
      opacity: 0.8;
    }
    /* å¼€å‘æµ‹è¯•æŒ‰é’®ï¼Œå¯éšè—äºç”Ÿäº§ç¯å¢ƒ */
    .test-btn {
      position: absolute;
      top: 8px;
      right: 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      color: var(--accent-color);
      font-size: 12px;
      padding: 3px 6px;
    }
    
    .reset-btn {
      position: absolute;
      top: 8px;
      right: 90px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      color: #ff6464;
      font-size: 12px;
      padding: 3px 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .reset-btn:hover {
      background: linear-gradient(135deg, #ff6464, #ff4444);
      color: var(--text-primary);
      transform: translateY(-1px);
    }
    
    .settings-btn {
      background: rgba(255,255,255,0.2) !important;
      color: #ffffff !important;
      border: 1px solid rgba(255,255,255,0.4) !important;
      border-radius: 8px !important;
      padding: 6px 10px !important;
      font-size: 14px !important;
      cursor: pointer !important;
      position: fixed !important;
      top: 10px !important;
      right: 10px !important;
      z-index: 999 !important;
      opacity: 0.9 !important;
      transition: all 0.3s ease !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
    }
    
    .settings-btn:hover {
      opacity: 1 !important;
      background: rgba(255,255,255,0.3) !important;
      border-color: rgba(255,255,255,0.6) !important;
      transform: scale(1.05) !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4) !important;
    }
    
    .theme-demo-btn {
      position: absolute;
      top: 8px;
      left: 12px;
      background: var(--btn-gradient);
      border: none;
      border-radius: 6px;
      color: var(--text-primary);
      font-size: 12px;
      padding: 3px 6px;
      cursor: pointer;
      box-shadow: var(--btn-shadow);
      transition: all 0.3s ease;
    }
    
    .theme-demo-btn:hover {
       transform: translateY(-1px);
       filter: brightness(1.1);
     }
     
     .test-btn {
       cursor: pointer;
       transition: all 0.3s ease;
    }
    .test-btn:hover {
      background: var(--btn-gradient);
      color: var(--text-primary);
    }

    /* ä¸­éƒ¨å†…å®¹å¡ç‰‡åŒºåŸŸ - å¯æ»šåŠ¨ */
    .content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden; /* ç¦æ­¢æ°´å¹³æ»šåŠ¨ */
      padding: 16px;
      padding-bottom: 100px; /* ä¸ºåº•éƒ¨å›ºå®šæŒ‰é’®ç•™å‡ºç©ºé—´ */
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .card {
      width: 100%;
      max-width: 480px;
      background: var(--bg-card);
      border-radius: 24px;
      padding: 24px;
      border: 1px solid var(--border-color);
      box-shadow: var(--btn-shadow);
      backdrop-filter: blur(16px);
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .section {
      margin-bottom: 16px;
      position: relative;
    }
    .section:last-child {
      margin-bottom: 0;
    }
    /* å…‰æ•ˆåˆ†å‰²çº¿ */
    .section:not(:last-child)::after {
      content: "";
      position: absolute;
      bottom: -8px;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
      opacity: 0.4;
    }
    .section-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 6px;
      color: var(--text-secondary);
    }
    .section-content {
      font-size: 14px;
      line-height: 1.4;
      color: var(--text-primary);
      opacity: 0.9;
    }
    /* ä»»åŠ¡åˆ—è¡¨æ ·å¼ */
    .task-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .task-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 0;
    }
    .task-item:not(:last-child) {
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    .task-title {
      flex: 1;
      font-size: 14px;
      color: #e0e5fb;
    }
    .task-status {
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 12px;
      background: linear-gradient(45deg, #00eaff, #0088ff);
      box-shadow: 0 0 6px rgba(0, 136, 255, 0.6);
      color: #031e2e;
    }
    .task-status.done {
      background: linear-gradient(45deg, #9be15d, #00e3ae);
      box-shadow: 0 0 6px rgba(0, 227, 174, 0.6);
    }
    /* å†æ¬¡æ¿€æ´»çªå‡ºæ ·å¼ */
    .reactivate-highlight {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(255, 193, 7, 0.15));
      border: 2px solid rgba(255, 107, 107, 0.3);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      position: relative;
      overflow: hidden;
    }
    .reactivate-highlight::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      animation: shimmer 2s infinite;
    }
    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    .reactivate-highlight .section-title {
      color: #ff6b6b;
      font-size: 18px;
      font-weight: 700;
      text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
    }
    .reactivate-btn {
      background: linear-gradient(45deg, #ff6b6b, #ffc107);
      border: none;
      border-radius: 25px;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
      transition: all 0.3s ease;
      width: 100%;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    .reactivate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
    }
    .reactivate-btn:active {
       transform: translateY(0);
     }

    /* åº•éƒ¨æŒ‰é’®åŒºåŸŸ - å›ºå®šåœ¨å±å¹•åº•éƒ¨ */
    .bottom {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 14px 16px calc(24px + env(safe-area-inset-bottom, 0px));
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      /* åŠé€æ˜èƒŒæ™¯ä¸æ¨¡ç³Šï¼Œä»¿åŸç”Ÿåº•éƒ¨æ  */
      background: rgba(255, 255, 255, 0.04);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      margin: 0 12px 12px;
      border-radius: 20px 20px 0 0;
      z-index: 100;
    }
    .bottom button {
      flex: 1;
      min-width: 0;
      border: none;
      border-radius: 16px;
      padding: 12px 8px;
      font-size: 13px;
      font-weight: 800;
      color: var(--text);
      cursor: pointer;
      transition: transform 0.08s ease, filter 0.2s ease, box-shadow 0.2s ease;
      /* é¿å…ç§»åŠ¨ç«¯æŒ‰é’®æ–‡å­—æ¢è¡Œ */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      background-image: linear-gradient(180deg, var(--brand), var(--brand-2));
      box-shadow: 0 8px 24px rgba(47, 128, 237, 0.45), inset 0 1px 0 rgba(255, 255, 255, 0.25);
    }
    /* å½“æŒ‰é’®è¶…è¿‡6ä¸ªæ—¶ï¼Œè°ƒæ•´å¸ƒå±€ */
    .bottom.many-buttons {
      justify-content: center;
    }
    .bottom.many-buttons button {
      flex: 0 1 calc(33.333% - 6px);
      margin: 2px;
      padding: 10px 6px;
      font-size: 12px;
    }
    /* æŒ‰é’®é¢œè‰²æ¸å˜ */
    .bottom button.red,
    .bottom button.orange,
    .bottom button.green,
    .bottom button.purple,
    .bottom button.blue {
      background: var(--btn-gradient);
      box-shadow: var(--btn-shadow), var(--btn-glow);
    }
    .bottom button:disabled {
      opacity: 0.4;
      cursor: default;
      filter: grayscale(0.6);
    }
    .bottom button:not(:disabled):hover {
      transform: translateY(-3px);
      filter: brightness(1.2);
    }
    .bottom button:not(:disabled):active {
      transform: translateY(0);
      filter: brightness(0.95);
    }
    /* é‚€è¯·æŒ‰é’®çªå‡ºæ˜¾ç¤ºï¼Œå¢åŠ å…‰æ™• */
    .bottom button[data-key="invite"],
    .bottom button[data-key="inviteNew"] {
      box-shadow: 0 12px 32px rgba(86, 204, 242, 0.55), inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
    /* ä¸»è¦çªå‡ºæŒ‰é’®æ ·å¼ - æ¿€æ´»è´¦å·ä¸“ç”¨ */
    .bottom button.primary-highlight {
      font-size: 18px !important;
      font-weight: bold !important;
      padding: 16px 24px !important;
      background: linear-gradient(135deg, #00ff88, #00cc66, #009944) !important;
      box-shadow: 0 8px 24px rgba(0, 255, 136, 0.4), 0 4px 12px rgba(0, 204, 102, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4) !important;
      border: 2px solid rgba(0, 255, 136, 0.6) !important;
      animation: pulse-glow 2s ease-in-out infinite !important;
    }
    .bottom button.primary-highlight:hover {
      transform: translateY(-4px) !important;
      box-shadow: 0 12px 32px rgba(0, 255, 136, 0.5), 0 6px 16px rgba(0, 204, 102, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.5) !important;
    }
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 8px 24px rgba(0, 255, 136, 0.4), 0 4px 12px rgba(0, 204, 102, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4); }
      50% { box-shadow: 0 12px 32px rgba(0, 255, 136, 0.6), 0 6px 16px rgba(0, 204, 102, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.5); }
    }
    /* ç»Ÿä¸€æ ·å¼çš„å¯¹è¯æ¡†æç¤º */
    .dialog {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .dialog .dialog-box {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px 24px;
      max-width: 90%;
      color: var(--text-primary);
      box-shadow: var(--btn-shadow);
      border: 1px solid var(--border-color);
    }
    .dialog .dialog-box h3 {
    }

    /* æ¨¡æ€æ¡†åŸºç¡€æ ·å¼ */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal-content {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 24px;
      position: relative;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border-color);
      max-height: 90vh;
      overflow-y: auto;
    }
    .modal-close {
      position: absolute;
      top: 12px;
      right: 12px;
      background: none;
      border: none;
      font-size: 20px;
      color: var(--text-secondary);
      cursor: pointer;
      padding: 4px;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    .modal-close:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-primary);
    }

    /* è®¾ç½®é¢æ¿æ ·å¼ */
    .settings-panel {
      padding: 0;
    }
    
    /* è®¾ç½®æ ‡é¢˜ */
    .settings-header {
      text-align: center;
      margin-bottom: 24px;
      padding-bottom: 20px;
      border-bottom: 2px solid var(--border-color);
    }
    .settings-header h2 {
      margin: 0;
      font-size: 20px;
      color: var(--text-primary);
      font-weight: 700;
    }
    
    /* ä¸ªäººèµ„æ–™å¡ç‰‡ */
    .profile-card {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 16px;
      box-shadow: 0 8px 24px rgba(47, 128, 237, 0.2);
    }
    .profile-avatar {
      flex-shrink: 0;
    }
    .avatar-circle {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      backdrop-filter: blur(10px);
    }
    .profile-info {
      flex: 1;
      color: white;
    }
    .profile-name {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .profile-code {
      font-size: 13px;
      opacity: 0.9;
    }
    .profile-level {
      flex-shrink: 0;
    }
    .level-badge {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      backdrop-filter: blur(10px);
    }
    
    /* è®¾ç½®åŒºåŸŸ */
    .settings-section {
      margin-bottom: 24px;
    }
    .settings-section h3 {
      margin: 0 0 12px 0;
      font-size: 16px;
      color: var(--text-primary);
      font-weight: 600;
    }
    
    /* è®¾ç½®å¡ç‰‡ */
    .settings-card {
      background: var(--bg-card);
      border-radius: 12px;
      border: 1px solid var(--border-color);
      overflow: hidden;
    }
    
    /* è®¾ç½®é¡¹ */
    .setting-item {
      display: flex;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid var(--border-color);
      transition: background-color 0.2s ease;
    }
    .setting-item:last-child {
      border-bottom: none;
    }
    .setting-item.clickable {
      cursor: pointer;
    }
    .setting-item.clickable:hover {
      background: rgba(47, 128, 237, 0.05);
    }
    .setting-info {
      flex: 1;
    }
    .setting-title {
      display: block;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 2px;
    }
    .setting-desc {
      display: block;
      font-size: 13px;
      color: var(--text-secondary);
    }
    .arrow {
      font-size: 18px;
      color: var(--text-secondary);
      font-weight: bold;
    }
    
    /* ä¸»é¢˜æŒ‰é’® */
    .theme-btn {
      background: var(--brand);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s ease;
    }
    .theme-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(47, 128, 237, 0.3);
    }
    .theme-preview {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
    }
    
    /* ç°ä»£åŒ–é€‰æ‹©æ¡† */
    .modern-select {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 14px;
      cursor: pointer;
      min-width: 140px;
      transition: all 0.2s ease;
    }
    .modern-select:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(47, 128, 237, 0.1);
    }
    
    /* Toggleå¼€å…³ */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 28px;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.3s;
      border-radius: 28px;
    }
    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    input:checked + .toggle-slider {
      background-color: var(--brand);
    }
    input:checked + .toggle-slider:before {
      transform: translateX(22px);
    }
    
    /* æ“ä½œæŒ‰é’® */
    .action-btn {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .action-btn:hover {
      background: var(--brand);
      color: white;
      border-color: var(--brand);
    }
    
    /* å±é™©æ“ä½œåŒºåŸŸ */
    .danger-zone {
      margin: 32px 0 24px 0;
    }
    .danger-zone h3 {
      margin: 0 0 12px 0;
      font-size: 16px;
      color: #ff6b6b;
      font-weight: 600;
    }
    .danger-card {
      background: rgba(255, 107, 107, 0.05);
      border: 1px solid rgba(255, 107, 107, 0.2);
      border-radius: 12px;
      padding: 20px;
    }
    .danger-warning {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      margin-bottom: 16px;
      padding: 12px;
      background: rgba(255, 107, 107, 0.1);
      border-radius: 8px;
    }
    .warning-icon {
      font-size: 20px;
      flex-shrink: 0;
    }
    .warning-text {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.4;
    }
    .danger-btn {
      background: linear-gradient(135deg, #ff6b6b, #ee5a52);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
    }
    .danger-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255, 107, 107, 0.4);
    }
    .danger-btn:active {
      transform: translateY(0);
    }
    
    /* è®¾ç½®é¡µè„š */
    .settings-footer {
      margin-top: 32px;
      padding-top: 20px;
      border-top: 2px solid var(--border-color);
      text-align: center;
    }
    .back-btn {
      background: linear-gradient(135deg, #4a90e2, #357abd);
      color: white;
      border: none;
      border-radius: 10px;
      padding: 14px 32px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
      min-width: 200px;
    }
    .back-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(74, 144, 226, 0.4);
    }
    .back-btn:active {
      transform: translateY(0);
    }
    
    /* å…¼å®¹æ—§æ ·å¼ */
    .settings-select:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 2px rgba(47, 128, 237, 0.2);
    }
    .dialog .dialog-box h3 {
      margin: 0 0 12px;
      font-size: 18px;
      color: var(--text-secondary);
    }
    .dialog .dialog-box p {
      margin: 0 0 20px;
      font-size: 14px;
      line-height: 1.4;
    }
    .dialog .dialog-box button {
      padding: 8px 16px;
      border: none;
      border-radius: 14px;
      background: var(--btn-gradient);
      color: var(--text-primary);
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--btn-shadow);
      margin: 0 5px;
    }
    
    .dialog .dialog-box .secondary-btn {
      background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
      color: white;
    }
    
    .dialog .dialog-box .danger-btn {
      background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
      color: white;
    }
    
    #dialogButtons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 10px;
    }
    /* é‚€è¯·åŒºé«˜äº®æ ·å¼ */
    .invite-highlight {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 12px;
      margin-top: 12px;
      box-shadow: var(--btn-glow);
    }
    .invite-highlight .section-title {
      color: var(--accent-color);
    }
    
    .invite-link-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .invite-link-container input {
      flex: 1;
      min-width: 0;
    }
    
    .invite-link-container button:hover {
      background: linear-gradient(135deg, #45a049, #3d8b40) !important;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K7WCTWLM"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <div id="app" class="app">
    <div class="header">
      <div class="header-main">
        <!-- æ”¾å¤§çš„logo -->
        <img src="logo_gold7.png" alt="Logo" class="logo-img" />
        <div class="status-info">
          <div id="stateLabel" class="state-label">çŠ¶æ€1</div>
          <div id="subtitle" class="subtitle">æ¬¢è¿åŠ å…¥è£‚é‡‘7æ—¥</div>
        </div>
      </div>
      <button class="theme-demo-btn" onclick="window.location.href='theme-demo.html'">ä¸»é¢˜æ¼”ç¤º</button>
      <button class="test-btn" onclick="cycleState()">åˆ‡æ¢çŠ¶æ€</button>
      <button class="reset-btn" onclick="resetTestData()">é‡ç½®æ•°æ®</button>
      <button class="settings-btn" onclick="console.log('è®¾ç½®æŒ‰é’®è¢«ç‚¹å‡»'); openSettings();">âš™ï¸</button>
    </div>
    <div class="content">
      <div id="card" class="card">
        <!-- åŠ¨æ€å†…å®¹å°†åœ¨è¿™é‡Œæ³¨å…¥ -->
      </div>
    </div>
    <div id="bottomButtons" class="bottom">
      <!-- åº•éƒ¨æŒ‰é’®åŠ¨æ€ç”Ÿæˆ -->
    </div>
  </div>
  <!-- æ¨¡æ€å¼¹çª— -->
  <div id="modal" class="modal" style="display:none;">
    <div class="modal-content">
      <button id="modalClose" class="modal-close">âœ•</button>
      <div id="modalBody"></div>
    </div>
  </div>
  <div id="dialog" class="dialog" style="display:none;">
    <div class="dialog-box">
      <h3 id="dialogTitle">æç¤º</h3>
      <p id="dialogMsg">å†…å®¹</p>
      <div id="dialogButtons">
        <button onclick="closeDialog()">ç¡®å®š</button>
      </div>
    </div>
  </div>

  <!-- è®¾ç½®é¢æ¿ -->
  <div id="settingsModal" class="modal" style="display:none;">
    <div class="modal-content" style="max-width: 420px; width: 95%; max-height: 90vh; overflow-y: auto;">
      <button class="modal-close" onclick="closeSettings()">âœ•</button>
      <div class="settings-panel">
        <!-- æ ‡é¢˜ -->
        <div class="settings-header">
          <h2>âš™ï¸ è®¾ç½®ä¸­å¿ƒ</h2>
        </div>
        
        <!-- ä¸ªäººèµ„æ–™å¡ç‰‡ -->
        <div class="profile-card">
          <div class="profile-avatar">
            <div class="avatar-circle">ğŸ‘¤</div>
          </div>
          <div class="profile-info">
            <div class="profile-name" id="userEmailDisplay">æœªç™»å½•</div>
            <div class="profile-code">é‚€è¯·ç ï¼š<span id="userInviteCodeDisplay">-</span></div>
          </div>
          <div class="profile-level">
            <span class="level-badge">LV.1</span>
          </div>
        </div>

        <!-- å¤–è§‚è®¾ç½® -->
        <div class="settings-section">
          <h3>ğŸ¨ å¤–è§‚è®¾ç½®</h3>
          <div class="settings-card">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-title">ä¸»é¢˜é£æ ¼</span>
                <span class="setting-desc">é€‰æ‹©æ‚¨å–œæ¬¢çš„ç•Œé¢ä¸»é¢˜</span>
              </div>
              <button class="theme-btn" onclick="window.location.href='theme-demo.html'">
                <span class="theme-preview"></span>
                åˆ‡æ¢
              </button>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-title">ğŸŒ è¯­è¨€</span>
                <span class="setting-desc">é€‰æ‹©ç•Œé¢æ˜¾ç¤ºè¯­è¨€</span>
              </div>
              <select id="languageSelect" class="modern-select">
                <option value="zh-CN">ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡</option>
                <option value="zh-TW">ğŸ‡¹ğŸ‡¼ ç¹é«”ä¸­æ–‡</option>
                <option value="en-US">ğŸ‡ºğŸ‡¸ English</option>
                <option value="ja-JP">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                <option value="ko-KR">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
              </select>
            </div>
          </div>
        </div>

        <!-- åŠŸèƒ½è®¾ç½® -->
        <div class="settings-section">
          <h3>ğŸ”§ åŠŸèƒ½è®¾ç½®</h3>
          <div class="settings-card">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-title">ğŸ”” æ¶ˆæ¯é€šçŸ¥</span>
                <span class="setting-desc">æ¥æ”¶é‡è¦æ¶ˆæ¯æé†’</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-title">ğŸ”Š éŸ³æ•ˆ</span>
                <span class="setting-desc">å¼€å¯æ“ä½œéŸ³æ•ˆåé¦ˆ</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-title">ğŸ“Š æ•°æ®ç®¡ç†</span>
                <span class="setting-desc">é‡ç½®æœ¬åœ°æµ‹è¯•æ•°æ®</span>
              </div>
              <button class="action-btn" onclick="resetTestData()">é‡ç½®</button>
            </div>
          </div>
        </div>

        <!-- å¸®åŠ©ä¸æ”¯æŒ -->
        <div class="settings-section">
          <h3>â“ å¸®åŠ©ä¸æ”¯æŒ</h3>
          <div class="settings-card">
            <div class="setting-item clickable" onclick="showHelp()">
              <div class="setting-info">
                <span class="setting-title">ğŸ“– ä½¿ç”¨å¸®åŠ©</span>
                <span class="setting-desc">æŸ¥çœ‹åŠŸèƒ½è¯´æ˜å’Œæ“ä½œæŒ‡å—</span>
              </div>
              <span class="arrow">â€º</span>
            </div>
            <div class="setting-item clickable" onclick="showFeedback()">
              <div class="setting-info">
                <span class="setting-title">ğŸ’¬ æ„è§åé¦ˆ</span>
                <span class="setting-desc">æäº¤å»ºè®®å’Œé—®é¢˜åé¦ˆ</span>
              </div>
              <span class="arrow">â€º</span>
            </div>
            <div class="setting-item clickable" onclick="showAbout()">
              <div class="setting-info">
                <span class="setting-title">â„¹ï¸ å…³äºæˆ‘ä»¬</span>
                <span class="setting-desc">ç‰ˆæœ¬ä¿¡æ¯å’Œå¼€å‘å›¢é˜Ÿ</span>
              </div>
              <span class="arrow">â€º</span>
            </div>
          </div>
        </div>

        <!-- å±é™©æ“ä½œåŒºåŸŸ -->
        <div class="danger-zone">
          <h3>âš ï¸ å±é™©æ“ä½œ</h3>
          <div class="danger-card">
            <div class="danger-warning">
              <span class="warning-icon">ğŸš¨</span>
              <div class="warning-text">
                <strong>æ³¨æ„ï¼š</strong>é€€å‡ºç™»å½•å°†æ¸…é™¤æ‰€æœ‰æœ¬åœ°æ•°æ®ï¼Œè¯·ç¡®ä¿é‡è¦ä¿¡æ¯å·²å¤‡ä»½
              </div>
            </div>
            <button class="danger-btn" onclick="confirmLogout()">
              ğŸšª é€€å‡ºç™»å½•
            </button>
          </div>
        </div>

        <!-- è¿”å›æŒ‰é’® -->
        <div class="settings-footer">
          <button class="back-btn" onclick="closeSettings()">
            â† è¿”å›ä¸»é¡µ
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // è®¾ç½®é¢æ¿åŠŸèƒ½ - æå‰å®šä¹‰ç¡®ä¿onclickå¯ä»¥æ‰¾åˆ°
    function openSettings() {
      console.log('openSettingså‡½æ•°è¢«è°ƒç”¨');
      const settingsModal = document.getElementById('settingsModal');
      console.log('settingsModalå…ƒç´ :', settingsModal);
      
      if (!settingsModal) {
        console.error('æ‰¾ä¸åˆ°settingsModalå…ƒç´ ');
        alert('è®¾ç½®é¢æ¿å…ƒç´ æœªæ‰¾åˆ°ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
        return;
      }
      
      settingsModal.style.display = 'flex';
      console.log('è®¾ç½®é¢æ¿å·²æ˜¾ç¤º');
      
      // æ›´æ–°ä¸ªäººä¿¡æ¯æ˜¾ç¤º
      updateProfileDisplay();
      
      // åŠ è½½ä¿å­˜çš„è®¾ç½®
      loadSettingsFromStorage();
    }

    function closeSettings() {
      const settingsModal = document.getElementById('settingsModal');
      settingsModal.style.display = 'none';
    }

    function updateSettingsInfo() {
      const userEmail = localStorage.getItem('userEmail') || 'æœªç™»å½•';
      const userInviteCode = localStorage.getItem('userInviteCode') || '-';
      const currentLanguage = localStorage.getItem('language') || 'zh-CN';
      
      document.getElementById('userEmailDisplay').textContent = userEmail;
      document.getElementById('userInviteCodeDisplay').textContent = userInviteCode;
      document.getElementById('languageSelect').value = currentLanguage;
    }

    /* çŠ¶æ€æ•°æ®ä¸é€»è¾‘å®šä¹‰ */
    const STATES = {
      1: {
        name: 'çŠ¶æ€1',
        subtitle: 'æ–°æ‰‹æœªå…¥é‡‘',
        card: function() {
          return `
            <div class="section reactivate-highlight">
              <div class="section-title">æ¿€æ´»è´¦å·</div>
              <div class="section-content" style="margin-bottom: 16px;">ç«‹å³å…¥é‡‘100 USDTï¼Œå¼€å¯168å°æ—¶æŒ‘æˆ˜æœŸï¼Œè§£é”ä»»åŠ¡ç³»ç»Ÿå’Œæ”¶ç›Šæœºä¼šã€‚</div>
              <button class="reactivate-btn" onclick="activateAccount()">ç«‹å³æ¿€æ´» 100 USDT</button>
            </div>
            <div class="section">
              <div class="section-title">æ”¶ç›Šé¢„è§ˆ</div>
              <div class="section-content">æŸ¥çœ‹å‰10åæ”¶ç›Šæ’è¡Œæ¦œï¼Œäº†è§£æ½œåœ¨æ”¶ç›Šæœºä¼šã€‚</div>
              <button onclick="showRanking()" style="margin-top: 12px; padding: 8px 16px; background: var(--btn-gradient); color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer; width: 100%; font-weight: 500; box-shadow: 0 2px 6px var(--accent-shadow); transition: all 0.2s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px var(--accent-shadow-hover)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 6px var(--accent-shadow)'">æŸ¥çœ‹æ’è¡Œæ¦œ</button>
            </div>
          `;
        },
        buttons: []
      },
      2: {
        name: 'çŠ¶æ€2',
        subtitle: '168å°æ—¶å€’è®¡æ—¶ä¸­',
        card: function() {
          // å½“å‰æ–°æ‰‹ä»»åŠ¡ï¼šåªæ˜¾ç¤ºå°šæœªå®Œæˆçš„ç¬¬ä¸€ä¸ªä»»åŠ¡
          const currentTask = newTasks.find(t => !t.done);
          let taskSection;
          if (currentTask) {
            taskSection = `
            <div class="section">
              <div class="section-title">å½“å‰ä»»åŠ¡</div>
              <div class="section-content">${currentTask.title}</div>
            </div>
            `;
          } else {
            taskSection = `
            <div class="section">
              <div class="section-title">å½“å‰ä»»åŠ¡</div>
              <div class="section-content">æ‰€æœ‰æ–°æ‰‹ä»»åŠ¡å·²å®Œæˆ</div>
            </div>
            `;
          }
          const completedTasks = newTasks.filter(t => t.done).length;
          
          // å¯æ¥çš„ä»»åŠ¡åŒºåŸŸï¼šæ˜¾ç¤ºæ‰€æœ‰æœªå®Œæˆçš„æ–°æ‰‹ä»»åŠ¡
          const availableTasks = newTasks.filter(t => !t.done);
          let availableTasksSection = '';
          if (availableTasks.length > 0) {
            availableTasksSection = `
            <div class="section" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 8px; margin-bottom: 8px; cursor: pointer;" onclick="window.location.href='tasks.html'">
              <div class="section-title" style="font-size: 14px; font-weight: bold; color: var(--accent-color); margin-bottom: 6px;">ğŸ“‹ å¯æ¥çš„ä»»åŠ¡</div>
              <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†ä»»åŠ¡åˆ—è¡¨</div>
              <div style="display: flex; flex-direction: column; gap: 4px;">
                ${availableTasks.map(task => `
                  <div style="display: flex; justify-content: space-between; align-items: center; padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="font-size: 12px; color: var(--text);">${task.title}</span>
                    <span style="font-size: 10px; padding: 2px 6px; background: linear-gradient(45deg, #00eaff, #0088ff); color: #031e2e; border-radius: 8px;">å¾…å®Œæˆ</span>
                  </div>
                `).join('')}
              </div>
            </div>
            `;
          }
          
          // ç­”é¢˜ä»»åŠ¡åŒºåŸŸï¼šå®Œæˆè‡³å°‘ä¸€ä¸ªæ–°æ‰‹ä»»åŠ¡åå‡ºç°ï¼Œä¸”æœªå®Œæˆå…¨éƒ¨20é¢˜
          const firstDone = newTasks[0] && newTasks[0].done;
          const quizCorrect = parseInt(localStorage.getItem('quizCorrect')) || 0;
          let quizSection = '';
          if (firstDone && quizCorrect < 20) {
            quizSection = `
            <div class="section" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 8px; margin-bottom: 8px; box-shadow: var(--btn-glow); cursor: pointer;" onclick="window.location.href='quiz.html'">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-size: 14px; font-weight: bold; color: var(--accent-color); margin-bottom: 2px;">ğŸ“ ç­”é¢˜ä»»åŠ¡</div>
                  <div style="font-size: 12px; color: var(--text-secondary);">é™ä½æç°æ‰‹ç»­è´¹</div>
                </div>
                <div style="text-align: right;">
                  <div style="font-size: 12px; color: var(--text-secondary);">è¿›åº¦</div>
                  <div style="font-weight: bold; color: var(--accent-color);">${quizCorrect}/20</div>
                </div>
              </div>
            </div>
            `;
          }
          
          // å¤§ç¥ä»»åŠ¡åŒºåŸŸï¼šå®Œæˆæ‰€æœ‰æ–°æ‰‹ä»»åŠ¡ä¸”å®Œæˆç­”é¢˜ä»»åŠ¡åæ˜¾ç¤º
          const allNewTasksCompleted = newTasks.every(task => task.done);
          const quizCompleted = quizCorrect >= 20;
          let masterTasksSection = '';
          if (allNewTasksCompleted && quizCompleted) {
            // è·å–å¤§ç¥ä»»åŠ¡å®ŒæˆçŠ¶æ€
            const godTasksCompleted = parseInt(localStorage.getItem('godTasksCompleted')) || 0;
            const currentMasterTask = godTasks.find(task => !task.done);
            
            masterTasksSection = `
            <div class="section" style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 8px; margin-bottom: 8px; box-shadow: var(--btn-glow); cursor: pointer;" onclick="window.location.href='tasks.html?tab=master'">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-size: 14px; font-weight: bold; color: var(--accent-color); margin-bottom: 2px;">ğŸ† å¤§ç¥ä»»åŠ¡</div>
                  <div style="font-size: 12px; color: var(--text-secondary);">${currentMasterTask ? currentMasterTask.title : 'æ‰€æœ‰å¤§ç¥ä»»åŠ¡å·²å®Œæˆ'}</div>
                </div>
                <div style="text-align: right;">
                  <div style="font-size: 12px; color: var(--text-secondary);">è¿›åº¦</div>
                  <div style="font-weight: bold; color: var(--accent-color);">${godTasksCompleted}/6</div>
                </div>
              </div>
            </div>
            `;
          }
          
          return `
            <div class="section" style="display: flex; gap: 12px; margin-bottom: 8px;">
              <div style="flex: 1; background: var(--bg-secondary); border-radius: 12px; padding: 16px; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 80px;">
                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">â° å€’è®¡æ—¶</div>
                <div style="font-weight: bold; color: var(--accent-color); font-size: 20px; line-height: 1;"><span id="countdown">--:--:--</span></div>
              </div>
              <div style="flex: 1.2; background: var(--bg-secondary); border-radius: 12px; padding: 12px;">
                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; text-align: center;">ğŸ† æˆ˜ç»©å¡</div>
                <div style="font-size: 11px; line-height: 1.3; color: var(--text-primary);">
                  <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                    <span>æ–°æ‰‹ä»»åŠ¡:</span>
                    <span style="color: var(--accent-color); font-weight: bold;"><span id="taskProgress">${completedTasks}</span>/3</span>
                  </div>
                  <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                     <span>ç­”é¢˜è¿›åº¦:</span>
                     <span style="color: var(--accent-color); font-weight: bold;">${quizCorrect}/20</span>
                   </div>
                  <div style="display: flex; justify-content: space-between; margin-bottom: 3px;">
                    <span>å›¢é˜Ÿäººæ•°:</span>
                    <span style="color: var(--accent-color); font-weight: bold;"><span id="teamCount">${teamMembers}</span>äºº</span>
                  </div>
                  <div style="display: flex; justify-content: space-between;">
                    <span>æ€»æ”¶ç›Š:</span>
                    <span style="color: var(--success-color); font-weight: bold;"><span id="totalEarnings">${totalEarnings.toFixed(2)}</span> USDT</span>
                  </div>
                </div>
              </div>
            </div>
            ${availableTasksSection}
            ${quizSection}
            ${masterTasksSection}
            <div class="section invite-highlight">
              <div class="section-title">é‚€è¯·é“¾æ¥</div>
              <div class="section-content">
                <!-- ä¸“å±é‚€è¯·ç åŒºåŸŸ -->
                <div style="margin-bottom: 12px; padding: 12px; background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 10px; box-shadow: 0 2px 8px var(--accent-shadow);">
                  <div style="font-size: 12px; color: var(--accent-color); margin-bottom: 8px; text-align: center; font-weight: 500;">ğŸ’ æˆ‘çš„ä¸“å±é‚€è¯·ç </div>
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <div style="flex: 1; font-weight: bold; color: var(--accent-color); font-size: 16px; text-align: center; padding: 10px; background: var(--input-bg); border-radius: 8px; border: 1px solid var(--border-color); box-shadow: inset 0 1px 3px var(--accent-shadow);" id="myInviteCode">ABC123</div>
                    <button onclick="copyInviteCode()" style="padding: 10px 16px; background: var(--btn-gradient); color: white; border: none; border-radius: 8px; font-size: 11px; cursor: pointer; white-space: nowrap; font-weight: 600; box-shadow: 0 2px 6px var(--accent-shadow); transition: all 0.2s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px var(--accent-shadow-hover)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 6px var(--accent-shadow)'">å¤åˆ¶ç </button>
                  </div>
                </div>
                
                <!-- é‚€è¯·é“¾æ¥åŒºåŸŸ -->
                <div style="padding: 12px; background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 10px; box-shadow: 0 2px 8px var(--accent-shadow);">
                  <div style="font-size: 12px; color: var(--accent-color); margin-bottom: 8px; text-align: center; font-weight: 500;">ğŸ”— é‚€è¯·é“¾æ¥</div>
                  <div class="invite-link-container" style="display: flex; gap: 8px;">
                    <input type="text" id="inviteLink" value="https://gold7.com/invite?code=ABC123" readonly style="flex: 1; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg); font-size: 11px; color: var(--accent-color); box-shadow: inset 0 1px 3px var(--accent-shadow);">
                    <button onclick="copyInviteLink()" style="padding: 10px 16px; background: var(--btn-gradient); color: white; border: none; border-radius: 8px; font-size: 11px; cursor: pointer; white-space: nowrap; font-weight: 600; box-shadow: 0 2px 6px var(--accent-shadow); transition: all 0.2s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px var(--accent-shadow-hover)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 6px var(--accent-shadow)'">å¤åˆ¶é“¾æ¥</button>
                  </div>
                </div>
              </div>
            </div>
          `;
        },
        buttons: [
          { text: 'ä»»åŠ¡', color: 'green', key: 'task', action: () => openTasks() },
          { text: 'çº¢åŒ…', color: 'red', key: 'red', action: () => grabRedPacket() },
          { text: 'å›¢é˜Ÿ', color: 'orange', key: 'team', action: () => showTeam() },
          { text: 'é’±åŒ…', color: 'purple', key: 'wallet', action: () => showWallet() },
          { text: 'æ’è¡Œ', color: 'green', key: 'rank', action: () => showRanking() }
        ]
      },
      3: {
        name: 'çŠ¶æ€3',
        subtitle: 'å€’è®¡æ—¶ç»“æŸæœªå¤è´­',
        card: function() {
          const completedTasks = newTasks.filter(t => t.done).length;
          return `
            <div class="section reactivate-highlight">
              <div class="section-title">ğŸ”¥ å†æ¬¡æ¿€æ´»</div>
              <div class="section-content">
                <p style="margin-bottom: 12px;">é‡æ–°å¼€å¯168å°æ—¶æŒ‘æˆ˜ï¼Œç»§ç»­èµšå–æ”¶ç›Šï¼</p>
                <button class="reactivate-btn" onclick="repurchase()">ç«‹å³æ¿€æ´» 100 USDT</button>
              </div>
            </div>
            <div class="section">
              <div class="section-title">æˆ˜ç»©å¡</div>
              <div class="section-content">æœ¬æœŸæ”¶ç›Šï¼š<strong>${totalEarnings.toFixed(2)} USDT</strong><br/>æ–°æ‰‹ä»»åŠ¡ï¼š${completedTasks}/3 å®Œæˆ<br/>å›¢é˜Ÿäººæ•°ï¼š${teamMembers}äºº</div>
            </div>
            <div class="section">
              <div class="section-title">æˆ‘çš„å›¢é˜Ÿ</div>
              <div class="section-content">æŸ¥çœ‹ä¸ƒå±‚å›¢é˜Ÿç»“æ„å’Œäººæ•°ã€‚</div>
            </div>
          `;
        },
        buttons: [
          { text: 'å›¢é˜Ÿ', color: 'orange', action: () => showTeam() },
          { text: 'é’±åŒ…', color: 'purple', action: () => showWallet() },
          { text: 'æ’è¡Œ', color: 'green', action: () => showRanking() }
        ]
      }
    };

    /* ä»»åŠ¡æ•°æ® */
    const newTasks = [
      { id: 1, title: 'ç›´æ¥æ¨è1äºº', desc: 'é‚€è¯·1ä½å¥½å‹æ³¨å†Œå¹¶æ¿€æ´»è´¦å·', done: false, reward: 10 },
      { id: 2, title: 'å¸®åŠ©ä¸‹çº§æ¨è1äºº', desc: 'æŒ‡å¯¼ä½ çš„ä¸‹çº§æˆåŠŸé‚€è¯·1ä½æ–°ç”¨æˆ·', done: false, reward: 10 },
      { id: 3, title: 'æ•™ä¸‹çº§å¦‚ä½•æ•™ä»–çš„ä¸‹çº§æ¨è1äºº', desc: 'åŸ¹è®­ä¸‹çº§çš„æ¨å¹¿æŠ€å·§ï¼Œå¸®åŠ©ä¸‰çº§æ¨å¹¿', done: false, reward: 10 }
    ];
    
    // ç­”é¢˜ä»»åŠ¡æ•°æ®
    const quizTasks = [
      { id: 'quiz1', title: 'åŸºç¡€çŸ¥è¯†ç­”é¢˜', desc: 'å®Œæˆ20é“åŸºç¡€é¢˜ç›®ï¼Œæ­£ç¡®ç‡è¾¾åˆ°80%', done: false, reward: 20, feeReduction: 0.02 }
    ];
    
    const godTasks = [
      { id: 1, title: 'å¤§ç¥ä»»åŠ¡ä¸€ï¼šç›´æ¨2äºº Ã— 2å±‚ = 6äºº', desc: 'å»ºç«‹2å±‚å›¢é˜Ÿç»“æ„ï¼Œæ¯å±‚2äºº', done: false, reward: 50 },
      { id: 2, title: 'å¤§ç¥ä»»åŠ¡äºŒï¼šç›´æ¨3äºº Ã— 3å±‚ = 39äºº', desc: 'å»ºç«‹3å±‚å›¢é˜Ÿç»“æ„ï¼Œæ¯å±‚3äºº', done: false, reward: 250 },
      { id: 3, title: 'å¤§ç¥ä»»åŠ¡ä¸‰ï¼šç›´æ¨4äºº Ã— 4å±‚ = 340äºº', desc: 'å»ºç«‹4å±‚å›¢é˜Ÿç»“æ„ï¼Œæ¯å±‚4äºº', done: false, reward: 1250 },
      { id: 4, title: 'å¤§ç¥ä»»åŠ¡å››ï¼šç›´æ¨5äºº Ã— 5å±‚ = 3905äºº', desc: 'å»ºç«‹5å±‚å›¢é˜Ÿç»“æ„ï¼Œæ¯å±‚5äºº', done: false, reward: 6250 },
      { id: 5, title: 'å¤§ç¥ä»»åŠ¡äº”ï¼šç›´æ¨6äºº Ã— 6å±‚ = 55986äºº', desc: 'å»ºç«‹6å±‚å›¢é˜Ÿç»“æ„ï¼Œæ¯å±‚6äºº', done: false, reward: 31250 },
      { id: 6, title: 'å¤§ç¥ä»»åŠ¡å…­ï¼šç›´æ¨7äºº Ã— 7å±‚ = 960799äºº', desc: 'å»ºç«‹7å±‚å›¢é˜Ÿç»“æ„ï¼Œæ¯å±‚7äºº', done: false, reward: 156250 }
    ];

    /* å…¨å±€çŠ¶æ€å˜é‡ */
    let currentState = 1;
    let countdownStart = null; // å¼€å¯å€’è®¡æ—¶çš„æ—¶é—´æˆ³
    let inviteStart = null;    // é‚€è¯·é“¾æ¥ç”Ÿæ•ˆæ—¶é—´æˆ³
    let countdownTimer = null;

    // æ¨¡æ‹Ÿç”¨æˆ·é’±åŒ…ä½™é¢ï¼Œç”¨äºçº¢åŒ…å’Œæç°åŠŸèƒ½
    let walletBalance = 0;

    // äº¤æ˜“è®°å½•åˆ—è¡¨
    let transactions = [];

    // æç°æ‰‹ç»­è´¹æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 5%ï¼ˆ0.05ï¼‰ï¼Œå¯é€šè¿‡ç­”é¢˜ä»»åŠ¡é™ä½ï¼Œæœ€ä½ 1%ï¼ˆ0.01ï¼‰
    let withdrawFeeRate = 0.05;

    // æ–°å¢çŠ¶æ€ç®¡ç†å˜é‡
    let userLevel = 0; // ç”¨æˆ·ç­‰çº§ 0:æœªæ¿€æ´» 1:å·²æ¿€æ´»
    let completedNewbieTasks = 0; // å·²å®Œæˆæ–°æ‰‹ä»»åŠ¡æ•°é‡
    let quizCompleted = false; // ç­”é¢˜ä»»åŠ¡æ˜¯å¦å®Œæˆ
    let godTasksUnlocked = false; // å¤§ç¥ä»»åŠ¡æ˜¯å¦è§£é”
    let teamMembers = 0; // å›¢é˜Ÿæˆå‘˜æ•°é‡
    let totalEarnings = 0; // æ€»æ”¶ç›Š

    /**
     * ä» localStorage åˆå§‹åŒ–çŠ¶æ€ï¼ŒåŒ…æ‹¬ä½™é¢ã€ä»»åŠ¡å®ŒæˆçŠ¶æ€å’Œäº¤æ˜“è®°å½•ã€‚
     */
    function loadState() {
      const savedState = localStorage.getItem('appState');
      if (savedState) {
        try {
          const state = JSON.parse(savedState);
          currentState = state.currentState || 1;
          countdownStart = state.countdownStart;
          inviteStart = state.inviteStart;
          walletBalance = state.walletBalance || 0;
          transactions = state.transactions || [];
          userLevel = state.userLevel || 0;
          completedNewbieTasks = state.completedNewbieTasks || 0;
          quizCompleted = state.quizCompleted || false;
          godTasksUnlocked = state.godTasksUnlocked || false;
          teamMembers = state.teamMembers || 0;
          totalEarnings = state.totalEarnings || 0;
          withdrawFeeRate = state.withdrawFeeRate || 0.05;
          
          // åŒæ­¥å›¢é˜Ÿæ”¶ç›Šï¼šæ€»æ”¶ç›Š = å›¢é˜Ÿäººæ•° * 10
          const teamData = JSON.parse(localStorage.getItem('teamData') || '{}');
          if (teamData.totalMembers) {
            totalEarnings = teamData.totalMembers * 10;
            teamMembers = teamData.totalMembers;
          }
          
          // æ¢å¤ä»»åŠ¡çŠ¶æ€
          if (state.newTasks) {
            state.newTasks.forEach((task, index) => {
              if (newTasks[index]) newTasks[index].done = task.done;
            });
            // åŒæ­¥completedNewbieTaskså˜é‡ï¼Œç¡®ä¿ä¸newTasksæ•°ç»„çŠ¶æ€ä¸€è‡´
            completedNewbieTasks = newTasks.filter(t => t.done).length;
          }
          if (state.quizTasks) {
            state.quizTasks.forEach((task, index) => {
              if (quizTasks[index]) quizTasks[index].done = task.done;
            });
          }
          if (state.godTasks) {
            state.godTasks.forEach((task, index) => {
              if (godTasks[index]) godTasks[index].done = task.done;
            });
          }
        } catch (e) {
          console.warn('æ— æ³•è§£æ appState', e);
        }
      }
    }

    /**
     * å°†å½“å‰çŠ¶æ€ä¿å­˜åˆ° localStorageã€‚
     */
    function saveState() {
      // åŒæ­¥å›¢é˜Ÿæ”¶ç›Šï¼šæ€»æ”¶ç›Š = å›¢é˜Ÿäººæ•° * 10
      const teamData = JSON.parse(localStorage.getItem('teamData') || '{}');
      if (teamData.totalMembers) {
        totalEarnings = teamData.totalMembers * 10;
      }
      
      const state = {
        currentState,
        countdownStart,
        inviteStart,
        walletBalance,
        transactions,
        userLevel,
        completedNewbieTasks,
        quizCompleted,
        godTasksUnlocked,
        teamMembers,
        totalEarnings,
        withdrawFeeRate,
        newTasks: newTasks.map(t => ({ ...t })),
        quizTasks: quizTasks.map(t => ({ ...t })),
        godTasks: godTasks.map(t => ({ ...t }))
      };
      localStorage.setItem('appState', JSON.stringify(state));
    }

    // ç”Ÿæˆç”¨æˆ·ä¸“å±é‚€è¯·ç 
    function generateUserInviteCode() {
      const userEmail = localStorage.getItem('userEmail');
      if (userEmail) {
        // ä½¿ç”¨é‚®ç®±å‰ç¼€ + éšæœº6ä½å­—ç¬¦ç”Ÿæˆé‚€è¯·ç 
        const emailPrefix = userEmail.split('@')[0].substring(0, 6).toUpperCase();
        const randomSuffix = Math.random().toString(36).substring(2, 8).toUpperCase();
        return emailPrefix + randomSuffix;
      }
      // å¦‚æœæ²¡æœ‰é‚®ç®±ï¼Œç”Ÿæˆéšæœºé‚€è¯·ç 
      return 'USER' + Math.random().toString(36).substring(2, 8).toUpperCase();
    }

    function init() {
      // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
      const userEmail = localStorage.getItem('userEmail');
      if (!userEmail) {
        // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
        window.location.href = 'login.html';
        return;
      }
      
      // ä» localStorage åŠ è½½å†å²çŠ¶æ€
      loadState();
      
      // ç”Ÿæˆæˆ–è·å–ç”¨æˆ·é‚€è¯·ç 
      let userInviteCode = localStorage.getItem('userInviteCode');
      if (!userInviteCode) {
        userInviteCode = generateUserInviteCode();
        localStorage.setItem('userInviteCode', userInviteCode);
      }
      
      renderState();
      
      // åˆå§‹åŒ–è®¾ç½®é¢æ¿äº‹ä»¶ç›‘å¬å™¨
      initSettingsEvents();
    }

    function renderState() {
      const state = STATES[currentState];
      document.getElementById('stateLabel').innerText = state.name;
      document.getElementById('subtitle').innerText = state.subtitle;
      // æ¸²æŸ“å¡ç‰‡å†…å®¹
      document.getElementById('card').innerHTML = state.card();
      
      // æ›´æ–°æˆ˜ç»©å¡æ•°æ®
      updateStatsDisplay();
      
      // æ¸²æŸ“åº•éƒ¨æŒ‰é’®
      const bottom = document.getElementById('bottomButtons');
      bottom.innerHTML = '';
      
      // ä¸¥æ ¼æŒ‰çŠ¶æ€æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
      const buttonsToShow = getButtonsForState(currentState);
      
      // å¦‚æœæŒ‰é’®è¶…è¿‡6ä¸ªï¼Œæ·»åŠ many-buttonsç±»
      if (buttonsToShow.length > 6) {
        bottom.classList.add('many-buttons');
      } else {
        bottom.classList.remove('many-buttons');
      }
      
      buttonsToShow.forEach(btnConfig => {
        const b = document.createElement('button');
        b.innerText = btnConfig.text;
        b.classList.add(btnConfig.color);
        b.onclick = btnConfig.action;
        // è®¾ç½® data-key ä»¥ä¾¿æ ·å¼å®šåˆ¶ï¼ˆå¦‚é‚€è¯·æŒ‰é’®é«˜äº®ï¼‰
        if (btnConfig.key) {
          b.dataset.key = btnConfig.key;
        }
        bottom.appendChild(b);
      });
      
      // æ§åˆ¶å€’è®¡æ—¶
      if (currentState === 2) {
        if (!countdownStart) {
          countdownStart = Date.now();
          inviteStart = countdownStart;
        }
        updateCountdown();
        countdownTimer = setInterval(updateCountdown, 1000);
      } else {
        if (countdownTimer) clearInterval(countdownTimer);
      }
    }
    
    // æ ¹æ®çŠ¶æ€ä¸¥æ ¼æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
    function getButtonsForState(state) {
      const baseButtons = STATES[state].buttons;
      const result = [...baseButtons];
      

      
      return result;
    }
    
    // æ›´æ–°æˆ˜ç»©å¡æ˜¾ç¤º
    function updateStatsDisplay() {
      const taskProgressEl = document.getElementById('taskProgress');
      const teamCountEl = document.getElementById('teamCount');
      const totalEarningsEl = document.getElementById('totalEarnings');
      
      // ä½¿ç”¨newTasksæ•°ç»„çš„å®é™…å®ŒæˆçŠ¶æ€ï¼Œç¡®ä¿ä¸å†…å®¹æ æ˜¾ç¤ºä¸€è‡´
      const actualCompletedTasks = newTasks.filter(t => t.done).length;
      if (taskProgressEl) taskProgressEl.innerText = actualCompletedTasks;
      if (teamCountEl) teamCountEl.innerText = teamMembers;
      if (totalEarningsEl) totalEarningsEl.innerText = totalEarnings.toFixed(2);
    }

    function updateCountdown() {
      // å€’è®¡æ—¶ 168h = 7*24*3600s
      const total = 168 * 3600 * 1000;
      const now = Date.now();
      const elapsed = now - countdownStart;
      let remaining = total - elapsed;
      if (remaining < 0) remaining = 0;
      const hrs = Math.floor(remaining / 3600000);
      const mins = Math.floor((remaining % 3600000) / 60000);
      const secs = Math.floor((remaining % 60000) / 1000);
      const str = `${String(hrs).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
      const countdownEl = document.getElementById('countdown');
      if (countdownEl) countdownEl.innerText = str;
      
      // æ›´æ–°é‚€è¯·é“¾æ¥æ˜¾ç¤º
      updateInviteDisplay();
      
      // å½“å€’è®¡æ—¶ç»“æŸï¼Œè‡ªåŠ¨è¿›å…¥çŠ¶æ€3
      if (remaining === 0 && currentState === 2) {
        currentState = 3;
        countdownStart = null;
        renderState();
      }
      // å½“å€’è®¡æ—¶ç»“æŸï¼Œä»çŠ¶æ€2å›åˆ°çŠ¶æ€3
      if (remaining === 0 && currentState === 2) {
        currentState = 3;
        countdownStart = null;
        renderState();
      }
    }
    
    // æ›´æ–°é‚€è¯·é“¾æ¥æ˜¾ç¤º
    function updateInviteDisplay() {
      // æ›´æ–°é‚€è¯·ç å’Œé‚€è¯·é“¾æ¥å†…å®¹
      const userInviteCode = localStorage.getItem('userInviteCode') || 'ABC123';
      
      // æ›´æ–°ä¸“å±é‚€è¯·ç æ˜¾ç¤º
      const inviteCodeEl = document.getElementById('myInviteCode');
      if (inviteCodeEl) {
        inviteCodeEl.textContent = userInviteCode;
      }
      
      // æ›´æ–°é‚€è¯·é“¾æ¥
      const inviteLinkEl = document.getElementById('inviteLink');
      if (inviteLinkEl) {
        inviteLinkEl.value = `https://gold7.com/login.html?invite=${userInviteCode}`;
      }
    }

    // å¼€å‘æµ‹è¯•å¾ªç¯çŠ¶æ€
    function cycleState() {
      currentState++;
      if (currentState > 3) currentState = 1;
      countdownStart = null;
      renderState();
    }

    // æ¿€æ´»è´¦å·/é¦–æ¬¡å…¥é‡‘
    function activateAccount() {
      showDialog('æ¿€æ´»è´¦å·', 'è¯·å‘ç³»ç»Ÿæä¾›çš„USDTåœ°å€æ”¯ä»˜100 USDTä»¥æ¿€æ´»è´¦å·ã€‚æ¿€æ´»åå°†å¼€å¯168å°æ—¶æŒ‘æˆ˜æœŸã€‚');
      // æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
      setTimeout(() => {
        // é¦–æ¬¡æ¿€æ´»è®°å½•äº¤æ˜“ï¼ˆå…¥é‡‘ä¸å½±å“ä½™é¢ï¼Œä½™é¢æ¥æºäºä½£é‡‘ï¼‰
        transactions.push({ 
          type: 'æ¿€æ´»ç¼´è´¹', 
          amount: -100, 
          fee: 0, 
          net: -100, 
          time: new Date().toISOString(),
          desc: 'é¦–æ¬¡æ¿€æ´»è´¦å·ç¼´è´¹' 
        });
        
        // æ›´æ–°çŠ¶æ€
        userLevel = 1;
        currentState = 2;
        countdownStart = Date.now();
        inviteStart = countdownStart;
        
        saveState();
        renderState();
        
        showDialog('æ¿€æ´»æˆåŠŸ', 'è´¦å·æ¿€æ´»æˆåŠŸï¼168å°æ—¶æŒ‘æˆ˜æœŸå·²å¼€å§‹ï¼Œè¯·å®Œæˆä»»åŠ¡è·å¾—æ”¶ç›Šã€‚');
      }, 1000);
    }

    // å†æ¬¡å…¥é‡‘ï¼ˆå¤è´­ï¼‰
    function repurchase() {
      showDialog('å†æ¬¡æ¿€æ´»', 'è¯·å‘ç³»ç»Ÿæä¾›çš„æ–°USDTåœ°å€æ”¯ä»˜100 USDTä»¥é‡æ–°æ¿€æ´»ã€‚é‡æ–°æ¿€æ´»åå°†å¼€å¯æ–°çš„168å°æ—¶æŒ‘æˆ˜æœŸã€‚');
      setTimeout(() => {
        // å¤è´­è®°å½•äº¤æ˜“
        transactions.push({ 
          type: 'å¤è´­ç¼´è´¹', 
          amount: -100, 
          fee: 0, 
          net: -100, 
          time: new Date().toISOString(),
          desc: 'å¤è´­æ¿€æ´»ç¼´è´¹' 
        });
        
        // æ›´æ–°çŠ¶æ€
        currentState = 2;
        countdownStart = Date.now();
        inviteStart = countdownStart;
        
        saveState();
        renderState();
        
        showDialog('å¤è´­æˆåŠŸ', 'å¤è´­æ¿€æ´»æˆåŠŸï¼æ–°çš„168å°æ—¶æŒ‘æˆ˜æœŸå·²å¼€å§‹ã€‚');
      }, 1000);
    }

    // ä»»åŠ¡æŒ‰é’® - å®ç°æŒ‰åºè§¦å‘é€»è¾‘
    function openTasks() {
      // æ‰¾åˆ°ä¸‹ä¸€ä¸ªæœªå®Œæˆçš„ä»»åŠ¡ï¼ˆæŒ‰IDé¡ºåºï¼‰
      const nextTask = newTasks.find(t => !t.done && t.id === completedNewbieTasks + 1);
      
      if (nextTask) {
        // æ˜¾ç¤ºä»»åŠ¡è¯¦æƒ…
        showDialog('å½“å‰ä»»åŠ¡', `ä»»åŠ¡${nextTask.id}ï¼š${nextTask.title}\n\n${nextTask.desc}\n\nå®Œæˆå¥–åŠ±ï¼š${nextTask.reward} USDT\n\nç‚¹å‡»ç¡®å®šæ ‡è®°å®Œæˆ`);
        
        // æ¨¡æ‹Ÿä»»åŠ¡å®Œæˆ
        setTimeout(() => {
          nextTask.done = true;
          // åŒæ­¥completedNewbieTaskså˜é‡ï¼Œç¡®ä¿ä¸newTasksæ•°ç»„çŠ¶æ€ä¸€è‡´
          completedNewbieTasks = newTasks.filter(t => t.done).length;
          
          // ä»»åŠ¡å¥–åŠ±
          walletBalance += nextTask.reward;
          totalEarnings += nextTask.reward;
          
          // è®°å½•äº¤æ˜“
          transactions.push({ 
            type: 'ä»»åŠ¡å¥–åŠ±', 
            amount: nextTask.reward, 
            fee: 0, 
            net: nextTask.reward, 
            time: new Date().toISOString(),
            desc: `å®Œæˆ${nextTask.title}` 
          });
          
          // æ£€æŸ¥æ˜¯å¦è§£é”ç­”é¢˜ä»»åŠ¡
          if (completedNewbieTasks >= 1 && !quizCompleted) {
            setTimeout(() => {
              showDialog('è§£é”ç­”é¢˜ä»»åŠ¡', 'æ­å–œï¼è§£é”ç­”é¢˜ä»»åŠ¡ï¼Œå®Œæˆå¯é™ä½æç°æ‰‹ç»­è´¹ï¼\n\nå½“å‰æ‰‹ç»­è´¹ï¼š' + ((withdrawFeeRate * 100).toFixed(1)) + '%');
            }, 500);
          }
          
          saveState();
          renderState();
          
          showDialog('ä»»åŠ¡å®Œæˆ', `æ­å–œå®Œæˆä»»åŠ¡ï¼š${nextTask.title}ï¼\nå¥–åŠ±ï¼š${nextTask.reward} USDT\nå½“å‰ä½™é¢ï¼š${walletBalance.toFixed(2)} USDT`);
        }, 1500);
      } else if (completedNewbieTasks >= 3) {
        // æ£€æŸ¥ç­”é¢˜ä»»åŠ¡çŠ¶æ€
        const quizCorrect = parseInt(localStorage.getItem('quizCorrect')) || 0;
        if (quizCorrect < 20) {
          showDialog('ç­”é¢˜ä»»åŠ¡', 'æ‰€æœ‰æ–°æ‰‹ä»»åŠ¡å·²å®Œæˆï¼\n\nç­”é¢˜ä»»åŠ¡å¯ç”¨ï¼Œå®Œæˆ20é¢˜å¯é™ä½æç°æ‰‹ç»­è´¹ã€‚\n\nå½“å‰æ‰‹ç»­è´¹ï¼š' + ((withdrawFeeRate * 100).toFixed(1)) + '%');
        } else {
          showDialog('æ–°æ‰‹ä»»åŠ¡', 'æ‰€æœ‰æ–°æ‰‹ä»»åŠ¡å·²å®Œæˆï¼\n\nç­”é¢˜ä»»åŠ¡ä¹Ÿå·²å®Œæˆï¼Œæ‰‹ç»­è´¹å·²é™è‡³æœ€ä½ã€‚');
        }
      } else {
        showDialog('ä»»åŠ¡ç³»ç»Ÿ', 'è¯·æŒ‰é¡ºåºå®Œæˆä»»åŠ¡ã€‚');
      }
    }
    

    
    // å¤åˆ¶é‚€è¯·é“¾æ¥
    function copyInvite() {
      const link = 'https://example.com/invite?code=ABC123';
      navigator.clipboard.writeText(link).then(() => {
        showDialog('é‚€è¯·é“¾æ¥å·²å¤åˆ¶', `æœ‰æ•ˆæœŸå‰©ä½™ ${document.getElementById('inviteLeft').innerText}ã€‚`);
      });
    }
    
    // æ–°çš„å¤åˆ¶é‚€è¯·é“¾æ¥å‡½æ•°
    function copyInviteLink() {
      const linkInput = document.getElementById('inviteLink');
      const link = linkInput.value;
      
      if (navigator.clipboard) {
        navigator.clipboard.writeText(link).then(() => {
          const detailedTime = getDetailedCountdown();
          showDialog('é‚€è¯·é“¾æ¥å·²å¤åˆ¶', `æœ‰æ•ˆæœŸå‰©ä½™ ${detailedTime}`);
        }).catch(() => {
          fallbackCopy(link);
        });
      } else {
        fallbackCopy(link);
      }
    }
    
    // å¤åˆ¶ä¸“å±é‚€è¯·ç å‡½æ•°
    function copyInviteCode() {
      const codeEl = document.getElementById('myInviteCode');
      const code = codeEl.textContent;
      
      if (navigator.clipboard) {
        navigator.clipboard.writeText(code).then(() => {
          const detailedTime = getDetailedCountdown();
          showDialog('é‚€è¯·ç å·²å¤åˆ¶', `ä¸“å±é‚€è¯·ç : ${code}\næœ‰æ•ˆæœŸå‰©ä½™ ${detailedTime}`);
        }).catch(() => {
          fallbackCopyCode(code);
        });
      } else {
        fallbackCopyCode(code);
      }
    }
    
    // è·å–è¯¦ç»†å€’è®¡æ—¶æ—¶é—´
    function getDetailedCountdown() {
      const total = 168 * 3600 * 1000;
      const now = Date.now();
      const inviteRemainingMs = Math.max(0, (inviteStart + total) - now);
      const days = Math.floor(inviteRemainingMs / (24 * 3600000));
      const hrs = Math.floor((inviteRemainingMs % (24 * 3600000)) / 3600000);
      const mins = Math.floor((inviteRemainingMs % 3600000) / 60000);
      
      let result = '';
      if (days > 0) result += `${days}å¤©`;
      if (hrs > 0) result += `${hrs}å°æ—¶`;
      if (mins > 0) result += `${mins}åˆ†é’Ÿ`;
      if (result === '') result = 'ä¸è¶³1åˆ†é’Ÿ';
      
      return result;
    }
    
    // é™çº§å¤åˆ¶æ–¹æ¡ˆ
    function fallbackCopy(text) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();
      try {
        document.execCommand('copy');
        const detailedTime = getDetailedCountdown();
        showDialog('é‚€è¯·é“¾æ¥å·²å¤åˆ¶', `æœ‰æ•ˆæœŸå‰©ä½™ ${detailedTime}`);
      } catch (err) {
        showDialog('å¤åˆ¶å¤±è´¥', 'è¯·æ‰‹åŠ¨å¤åˆ¶é“¾æ¥');
      }
      document.body.removeChild(textArea);
    }
    
    // é™çº§å¤åˆ¶é‚€è¯·ç æ–¹æ¡ˆ
    function fallbackCopyCode(code) {
      const textArea = document.createElement('textarea');
      textArea.value = code;
      document.body.appendChild(textArea);
      textArea.select();
      try {
        document.execCommand('copy');
        const detailedTime = getDetailedCountdown();
        showDialog('é‚€è¯·ç å·²å¤åˆ¶', `ä¸“å±é‚€è¯·ç : ${code}\næœ‰æ•ˆæœŸå‰©ä½™ ${detailedTime}`);
      } catch (err) {
        showDialog('å¤åˆ¶å¤±è´¥', 'è¯·æ‰‹åŠ¨å¤åˆ¶é‚€è¯·ç ');
      }
      document.body.removeChild(textArea);
    }
    // æŠ¢çº¢åŒ… - ä¸¥æ ¼æ—¶é—´çª—å£å’Œèµ„æ ¼æ ¡éªŒ
    function grabRedPacket() {
      // æ£€æŸ¥èµ„æ ¼ï¼šä»…çŠ¶æ€2æˆ–4
      if (currentState !== 2) {
        showDialog('æ— æŠ¢çº¢åŒ…èµ„æ ¼', 'åªæœ‰åœ¨æ¿€æ´»çŠ¶æ€ï¼ˆåˆæ¬¡æŒ‘æˆ˜æˆ–å¤è´­çŠ¶æ€ï¼‰æ‰å¯ä»¥æŠ¢çº¢åŒ…ã€‚');
        return;
      }
      
      // ä¸¥æ ¼æ—¶é—´æ£€æŸ¥ï¼šæ¯æ—¥9:00/12:00/20:00 å¼€å§‹ï¼ŒæŒç»­77ç§’
      const now = new Date();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const seconds = now.getSeconds();
      
      const isValidHour = hours === 9 || hours === 12 || hours === 20;
      const isValidTime = isValidHour && minutes === 0 && seconds < 77;
      
      if (!isValidTime) {
        // è®¡ç®—ä¸‹ä¸€åœºçº¢åŒ…æ—¶é—´
        let nextHour;
        if (hours < 9) nextHour = 9;
        else if (hours < 12) nextHour = 12;
        else if (hours < 20) nextHour = 20;
        else nextHour = 9; // æ˜å¤©9ç‚¹
        
        const nextDay = hours >= 20 ? 'æ˜æ—¥' : 'ä»Šæ—¥';
        showDialog('çº¢åŒ…æœªå¼€å§‹', `çº¢åŒ…æ´»åŠ¨æ¯æ—¥9:00ã€12:00ã€20:00å¼€å§‹ï¼Œæ¯æ¬¡ä»…å¼€æ”¾77ç§’ã€‚\n\nä¸‹ä¸€åœºï¼š${nextDay} ${nextHour}:00`);
        return;
      }
      
      // æ£€æŸ¥æ˜¯å¦å·²ç»æŠ¢è¿‡ï¼ˆæ¯åœºé™æŠ¢ä¸€æ¬¡ï¼‰
      const todayKey = now.toDateString();
      const sessionKey = `${todayKey}_${hours}`;
      const grabbedSessions = JSON.parse(localStorage.getItem('grabbedSessions') || '[]');
      
      if (grabbedSessions.includes(sessionKey)) {
        showDialog('å·²æŠ¢è¿‡çº¢åŒ…', 'æœ¬åœºçº¢åŒ…å·²æŠ¢è¿‡ï¼Œè¯·ç­‰å¾…ä¸‹ä¸€åœºã€‚');
        return;
      }
      
      // æŠ¢çº¢åŒ…æˆåŠŸ
      const prize = parseFloat((Math.random() * 4.99 + 0.01).toFixed(2));
      walletBalance += prize;
      totalEarnings += prize;
      
      // è®°å½•æœ¬åœºå·²æŠ¢
      grabbedSessions.push(sessionKey);
      localStorage.setItem('grabbedSessions', JSON.stringify(grabbedSessions));
      
      // è®°å½•äº¤æ˜“
      transactions.push({ 
        type: 'çº¢åŒ…æ”¶å…¥', 
        amount: prize, 
        fee: 0, 
        net: prize, 
        time: new Date().toISOString(),
        desc: `${hours}:00åœºçº¢åŒ…` 
      });
      
      saveState();
      renderState();
      
      showDialog('æŠ¢çº¢åŒ…æˆåŠŸ', `ğŸ‰ æ­å–œæŠ¢åˆ°çº¢åŒ…ï¼š${prize.toFixed(2)} USDTï¼\n\nå½“å‰ä½™é¢ï¼š${walletBalance.toFixed(2)} USDT\nå‰©ä½™æ—¶é—´ï¼š${77 - seconds}ç§’`);
    }
    // æˆ‘çš„å›¢é˜Ÿ
    function showTeam() {
      // è·³è½¬åˆ°å›¢é˜Ÿé¡µé¢
      window.location.href = 'team.html';
    }
    // æˆ‘çš„é’±åŒ…
    function showWallet() {
      // è·³è½¬åˆ°é’±åŒ…é¡µé¢
      window.location.href = 'wallet.html';
    }
    // æ’è¡Œæ¦œ
    function showRanking() {
      // è·³è½¬åˆ°æ’è¡Œæ¦œé¡µé¢
      window.location.href = 'ranking.html';
    }
    function showRedRanking() {
      showDialog('çº¢åŒ…æ’è¡Œæ¦œ', 'æŒ‰çº¢åŒ…æ”¶å…¥USDTæ€»é¢æ’è¡Œã€‚');
    }
    function showGodRanking() {
      showDialog('å¤§ç¥æ’è¡Œæ¦œ', 'æŒ‰å¤§ç¥ç­‰çº§æ’è¡Œã€‚');
    }
    function openGodTasks() {
      showDialog('å¤§ç¥ä»»åŠ¡', 'è¯·åœ¨å¡ç‰‡ä¸­æŸ¥çœ‹å¤§ç¥ä»»åŠ¡ç›®æ ‡ã€‚');
    }
    /* å¯¹è¯æ¡† */
    function showDialog(title, msg, buttons = null) {
      document.getElementById('dialogTitle').innerText = title;
      document.getElementById('dialogMsg').innerText = msg;
      
      const dialogButtons = document.getElementById('dialogButtons');
      
      if (buttons && Array.isArray(buttons)) {
        // è‡ªå®šä¹‰æŒ‰é’®
        dialogButtons.innerHTML = '';
        buttons.forEach(button => {
          const btn = document.createElement('button');
          btn.textContent = button.text;
          btn.className = button.style === 'danger' ? 'danger-btn' : (button.style === 'secondary' ? 'secondary-btn' : '');
          btn.onclick = () => {
            closeDialog();
            if (button.action) {
              button.action();
            }
          };
          dialogButtons.appendChild(btn);
        });
      } else {
        // é»˜è®¤ç¡®å®šæŒ‰é’®
        dialogButtons.innerHTML = '<button onclick="closeDialog()">ç¡®å®š</button>';
      }
      
      document.getElementById('dialog').style.display = 'flex';
    }
    function closeDialog() {
      document.getElementById('dialog').style.display = 'none';
    }

    /**
     * é‡ç½®æµ‹è¯•æ•°æ®
     */
    function resetTestData() {
      if(confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æµ‹è¯•æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
        // é‡ç½®æ‰€æœ‰ä»»åŠ¡çŠ¶æ€
        newTasks.forEach(task => task.done = false);
        quizCompleted = false;
        godTasksCompleted = false;
        
        // ç”Ÿæˆéšæœºå›¢é˜Ÿäººæ•° (1-50äºº)
        const randomTeamSize = Math.floor(Math.random() * 50) + 1;
        
        // è®¾ç½®ä½™é¢ä¸ºå›¢é˜Ÿäººæ•°*10 USDT
        const newBalance = randomTeamSize * 10;
        
        // æ¸…ç©ºlocalStorageä¸­çš„ç›¸å…³æ•°æ®
        localStorage.removeItem('userTasks');
        localStorage.removeItem('quizCompleted');
        localStorage.removeItem('godTasksCompleted');
        localStorage.removeItem('userBalance');
        localStorage.removeItem('teamSize');
        
        // é‡ç½®ç­”é¢˜ç›¸å…³æ•°æ®
        localStorage.removeItem('quizIndex');
        localStorage.removeItem('quizCorrect');
        localStorage.setItem('withdrawFeeRate', '0.05'); // é‡ç½®æ‰‹ç»­è´¹ä¸º5%
        
        // æ¸…é™¤äº¤æ˜“è®°å½•å’Œåº”ç”¨çŠ¶æ€æ•°æ®
        localStorage.removeItem('transactions');
        localStorage.removeItem('appState');
        localStorage.removeItem('teamData');
        localStorage.removeItem('recentRed');
        
        // é‡ç½®å…¨å±€å˜é‡åˆ°åˆå§‹çŠ¶æ€
        transactions = [];
        userLevel = 0;
        completedNewbieTasks = 0;
        godTasksUnlocked = false;
        teamMembers = randomTeamSize;
        totalEarnings = randomTeamSize * 10;
        withdrawFeeRate = 0.05;
        walletBalance = randomTeamSize * 10;
        countdownStart = null;
        inviteStart = null;
        
        // è®¾ç½®æ–°çš„æ•°æ®åˆ°localStorage
        localStorage.setItem('teamSize', randomTeamSize.toString());
        localStorage.setItem('userBalance', newBalance.toString());
        
        // é‡ç½®åˆ°çŠ¶æ€1
        currentState = 1;
        
        // é‡æ–°æ¸²æŸ“é¡µé¢
        renderState();
        
        // å¼ºåˆ¶æ˜¾ç¤ºé£æ ¼é€‰æ‹©å¼¹çª—
        showForceThemeSelection(randomTeamSize, newBalance);
      }
    }

    /**
     * å¼ºåˆ¶é£æ ¼é€‰æ‹©å¼¹çª—
     */
    function showForceThemeSelection(teamSize, balance) {
      const themes = {
        'cyberpunk': { name: 'èµ›åšæœ‹å…‹', icon: 'ğŸŒ†', description: 'æœªæ¥ç§‘æŠ€æ„Ÿ' },
        'rainbow': { name: 'å½©è™¹æ¸å˜', icon: 'ğŸŒˆ', description: 'å¤šå½©ç»šçƒ‚' },
        'business': { name: 'å•†åŠ¡è“', icon: 'ğŸ’¼', description: 'ä¸“ä¸šç¨³é‡' },
        'dark-tech': { name: 'æš—é»‘ç§‘æŠ€', icon: 'âš¡', description: 'ç¥ç§˜é…·ç‚«' },
        'fresh': { name: 'æ¸…æ–°ç»¿', icon: 'ğŸŒ¿', description: 'è‡ªç„¶æ¸…æ–°' }
      };
      
      const themeOptionsHTML = Object.entries(themes).map(([key, theme]) => `
        <div class="force-theme-option" data-theme="${key}">
          <span class="force-theme-icon">${theme.icon}</span>
          <div class="force-theme-info">
            <div class="force-theme-name">${theme.name}</div>
            <div class="force-theme-desc">${theme.description}</div>
          </div>
        </div>
      `).join('');
      
      const modalHTML = `
        <div id="forceThemeModal" class="force-theme-modal">
          <div class="force-theme-content">
            <div class="force-theme-header">
              <h2>ğŸ¨ é€‰æ‹©æ‚¨çš„ä¸“å±é£æ ¼</h2>
              <p>æ•°æ®é‡ç½®æˆåŠŸï¼è¯·é€‰æ‹©ä¸€ä¸ªé£æ ¼ä¸»é¢˜ç»§ç»­ä½¿ç”¨</p>
            </div>
            <div class="force-theme-options">
              ${themeOptionsHTML}
            </div>
            <div class="force-theme-footer">
              <p class="force-theme-info-text">å›¢é˜Ÿäººæ•°ï¼š${teamSize}äºº | ä½™é¢ï¼š${balance} USDT | æ‰€æœ‰ä»»åŠ¡å·²é‡ç½®</p>
            </div>
          </div>
        </div>
      `;
      
      // æ·»åŠ æ ·å¼
      const styleHTML = `
        <style>
        .force-theme-modal {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.8);
          display: flex;
          justify-content: center;
          align-items: center;
          z-index: 10000;
          backdrop-filter: blur(10px);
        }
        .force-theme-content {
          background: var(--bg-card);
          border-radius: 20px;
          padding: 24px;
          max-width: 400px;
          width: 90%;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
          border: 1px solid var(--border-color);
        }
        .force-theme-header {
          text-align: center;
          margin-bottom: 20px;
        }
        .force-theme-header h2 {
          color: var(--text-primary);
          margin: 0 0 8px 0;
          font-size: 20px;
        }
        .force-theme-header p {
          color: var(--text-secondary);
          margin: 0;
          font-size: 14px;
        }
        .force-theme-options {
          display: flex;
          flex-direction: column;
          gap: 8px;
          margin-bottom: 20px;
        }
        .force-theme-option {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px;
          border: 2px solid var(--border-color);
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.3s ease;
          background: var(--bg-secondary);
        }
        .force-theme-option:hover {
          border-color: var(--accent-color);
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        .force-theme-option.selected {
          border-color: var(--accent-color);
          background: var(--btn-gradient);
          color: var(--text-primary);
        }
        .force-theme-icon {
          font-size: 24px;
          width: 32px;
          text-align: center;
        }
        .force-theme-info {
          flex: 1;
        }
        .force-theme-name {
          font-weight: 600;
          font-size: 16px;
          margin-bottom: 2px;
        }
        .force-theme-desc {
          font-size: 12px;
          opacity: 0.8;
        }
        .force-theme-footer {
          text-align: center;
        }
        .force-theme-info-text {
          font-size: 12px;
          color: var(--text-secondary);
          margin: 0;
        }
        </style>
      `;
      
      // æ’å…¥æ ·å¼å’Œæ¨¡æ€æ¡†
      document.head.insertAdjacentHTML('beforeend', styleHTML);
      document.body.insertAdjacentHTML('beforeend', modalHTML);
      
      // ç»‘å®šäº‹ä»¶
      const modal = document.getElementById('forceThemeModal');
      const options = document.querySelectorAll('.force-theme-option');
      
      options.forEach(option => {
        option.addEventListener('click', () => {
          const selectedTheme = option.getAttribute('data-theme');
          
          // åº”ç”¨é€‰ä¸­çš„ä¸»é¢˜
          if (window.themeSwitcher) {
            window.themeSwitcher.switchTheme(selectedTheme);
          } else {
            document.documentElement.setAttribute('data-theme', selectedTheme === 'cyberpunk' ? '' : selectedTheme);
            localStorage.setItem('selectedTheme', selectedTheme);
          }
          
          // å…³é—­æ¨¡æ€æ¡†
          modal.remove();
          
          // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
          const themeName = themes[selectedTheme].name;
          showDialog('é£æ ¼è®¾ç½®æˆåŠŸ', `å·²åˆ‡æ¢è‡³${themeName}é£æ ¼\nå›¢é˜Ÿäººæ•°ï¼š${teamSize}äºº\nä½™é¢ï¼š${balance} USDT\næ‰€æœ‰ä»»åŠ¡å·²é‡ç½®`);
        });
      });
    }

    /**
     * æ¨¡æ€å¼¹çª—ç®¡ç†
     */
    const modal = document.getElementById('modal');
    const modalClose = document.getElementById('modalClose');
    const modalBody = document.getElementById('modalBody');
    modalClose.addEventListener('click', () => {
      modal.style.display = 'none';
    });
    function openModal(type) {
      let html = '';
      if(type === 'task') {
        const currentTask = newTasks.find(t => !t.done);
        if(currentTask) {
          html += `<h3 style="margin-top:0;color:var(--brand)">${currentTask.title}</h3>`;
          html += `<p style="font-size:14px;color:var(--muted)">${currentTask.desc ? currentTask.desc : 'å®Œæˆæ­¤ä»»åŠ¡å¯æ¨è¿›è¿›åº¦ã€‚'}</p>`;
          html += `<button class="btn" id="modalTaskDone" style="margin-top:16px;width:100%">æ ‡è®°å®Œæˆ</button>`;
        } else {
          html += `<h3 style="margin-top:0;color:var(--brand)">æ‰€æœ‰æ–°æ‰‹ä»»åŠ¡å·²å®Œæˆ</h3>`;
          html += `<p style="font-size:14px;color:var(--muted)">æ— éœ€å†æ‰§è¡Œæ–°æ‰‹ä»»åŠ¡ã€‚</p>`;
        }
      } else if(type === 'wallet') {
        html += `<h3 style="margin-top:0;color:var(--brand)">æˆ‘çš„é’±åŒ…</h3>`;
        html += `<p style="font-size:14px;color:var(--muted)">å½“å‰ä½™é¢ï¼š-- USDT</p>`;
        html += `<button class="btn" style="margin-top:16px;width:100%">æç°</button>`;
      } else if(type === 'team') {
        html += `<h3 style="margin-top:0;color:var(--brand)">æˆ‘çš„å›¢é˜Ÿ</h3>`;
        html += `<p style="font-size:14px;color:var(--muted)">æ­¤å¤„å±•ç¤ºä¸ƒå±‚å›¢é˜Ÿç»“æ„ï¼ˆå ä½ï¼‰</p>`;
      } else if(type === 'ranking') {
        html += `<h3 style="margin-top:0;color:var(--brand)">æ’è¡Œæ¦œ</h3>`;
        html += `<p style="font-size:14px;color:var(--muted)">æ­¤å¤„å±•ç¤ºå›¢é˜Ÿã€çº¢åŒ…ä¸å¤§ç¥æ’è¡Œï¼ˆå ä½ï¼‰</p>`;
      }
      modalBody.innerHTML = html;
      modal.style.display = 'flex';
      // ç»‘å®šä»»åŠ¡å®ŒæˆæŒ‰é’®
      const completeBtn = document.getElementById('modalTaskDone');
      if(completeBtn) {
        completeBtn.addEventListener('click', () => {
          const task = newTasks.find(t => !t.done);
          if(task) task.done = true;
          modal.style.display = 'none';
          renderState();
        });
      }
    }

    // é€€å‡ºç™»å½•åŠŸèƒ½
    // ç¡®è®¤é€€å‡ºç™»å½•
    function confirmLogout() {
      // å…ˆå…³é—­è®¾ç½®ç•Œé¢
      closeSettings();
      
      // ç„¶åæ˜¾ç¤ºç¡®è®¤é€€å‡ºå¯¹è¯æ¡†
      showDialog('ç¡®è®¤é€€å‡º', 'é€€å‡ºç™»å½•å°†æ¸…é™¤æ‰€æœ‰æœ¬åœ°æ•°æ®ï¼Œç¡®å®šè¦ç»§ç»­å—ï¼Ÿ', [
        {
          text: 'å–æ¶ˆ',
          style: 'secondary',
          action: () => {}
        },
        {
          text: 'ç¡®è®¤é€€å‡º',
          style: 'danger',
          action: logout
        }
      ]);
    }
    
    function logout() {
      // æ¸…é™¤æ‰€æœ‰ç”¨æˆ·ç›¸å…³çš„æœ¬åœ°å­˜å‚¨æ•°æ®
      localStorage.removeItem('userEmail');
      localStorage.removeItem('userPassword');
      localStorage.removeItem('appState');
      localStorage.removeItem('userInviteCode');
      localStorage.removeItem('teamData');
      localStorage.removeItem('language');
      localStorage.removeItem('userStatus');
      localStorage.removeItem('inviteCode');
      
      // ç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µé¢
      window.location.href = 'login.html';
    }
    
    // æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
    function showHelp() {
      showDialog('ä½¿ç”¨å¸®åŠ©', 'è¿™é‡Œæ˜¯åŠŸèƒ½è¯´æ˜å’Œæ“ä½œæŒ‡å—\n\nâ€¢ æ¿€æ´»è´¦å·ï¼šå®Œæˆé‚®ç®±éªŒè¯\nâ€¢ é‚€è¯·å¥½å‹ï¼šåˆ†äº«ä¸“å±é‚€è¯·ç \nâ€¢ å®Œæˆä»»åŠ¡ï¼šè·å¾—å¥–åŠ±ç§¯åˆ†\nâ€¢ æŠ¢çº¢åŒ…ï¼šåœ¨æŒ‡å®šæ—¶é—´å‚ä¸\nâ€¢ æŸ¥çœ‹æ’è¡Œï¼šäº†è§£å½“å‰æ’å');
    }
    
    // æ˜¾ç¤ºæ„è§åé¦ˆ
    function showFeedback() {
      showDialog('æ„è§åé¦ˆ', 'æ„Ÿè°¢æ‚¨çš„å®è´µæ„è§ï¼\n\nè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ä»¬ï¼š\nâ€¢ é‚®ç®±ï¼šfeedback@example.com\nâ€¢ å¾®ä¿¡ï¼šgoldapp_support\nâ€¢ QQç¾¤ï¼š123456789');
    }
    
    // æ˜¾ç¤ºå…³äºä¿¡æ¯
    function showAbout() {
      showDialog('å…³äºæˆ‘ä»¬', 'è£‚é‡‘7æ—¥ H5åº”ç”¨\n\nç‰ˆæœ¬ï¼šv1.0.0\næ›´æ–°æ—¶é—´ï¼š2024å¹´1æœˆ\n\nå¼€å‘å›¢é˜Ÿè‡´åŠ›äºä¸ºç”¨æˆ·æä¾›\næœ€ä½³çš„äº’åŠ¨ä½“éªŒ');
    }

    // è®¾ç½®é¢æ¿åŠŸèƒ½å·²ç§»è‡³scriptå¼€å¤´

    // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
    function selectTheme(theme) {
      // ç§»é™¤æ‰€æœ‰ä¸»é¢˜æŒ‰é’®çš„activeçŠ¶æ€
      document.querySelectorAll('.theme-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // æ¿€æ´»é€‰ä¸­çš„ä¸»é¢˜æŒ‰é’®
      event.target.classList.add('active');
      
      // ä¿å­˜ä¸»é¢˜è®¾ç½®
      localStorage.setItem('theme', theme);
      
      // åº”ç”¨ä¸»é¢˜ï¼ˆè¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„ä¸»é¢˜åˆ‡æ¢é€»è¾‘ï¼‰
      showDialog('ä¸»é¢˜è®¾ç½®', `å·²åˆ‡æ¢åˆ°${theme}ä¸»é¢˜`);
    }
    
    // Toggleå¼€å…³åŠŸèƒ½
    function toggleSwitch(switchId) {
      const toggle = document.getElementById(switchId);
      const isChecked = toggle.checked;
      
      // ä¿å­˜è®¾ç½®
      localStorage.setItem(switchId, isChecked);
      
      // æ ¹æ®ä¸åŒçš„å¼€å…³æ‰§è¡Œä¸åŒçš„é€»è¾‘
      switch(switchId) {
        case 'soundToggle':
          showDialog('å£°éŸ³è®¾ç½®', isChecked ? 'å·²å¼€å¯å£°éŸ³æ•ˆæœ' : 'å·²å…³é—­å£°éŸ³æ•ˆæœ');
          break;
        case 'vibrationToggle':
          showDialog('éœ‡åŠ¨è®¾ç½®', isChecked ? 'å·²å¼€å¯éœ‡åŠ¨åé¦ˆ' : 'å·²å…³é—­éœ‡åŠ¨åé¦ˆ');
          break;
        case 'notificationToggle':
          showDialog('é€šçŸ¥è®¾ç½®', isChecked ? 'å·²å¼€å¯æ¨é€é€šçŸ¥' : 'å·²å…³é—­æ¨é€é€šçŸ¥');
          break;
      }
    }
    
    // è¯­è¨€åˆ‡æ¢åŠŸèƒ½
    function changeLanguage() {
      const select = document.getElementById('languageSelect');
      const selectedLanguage = select.value;
      const selectedText = select.options[select.selectedIndex].text;
      
      localStorage.setItem('language', selectedLanguage);
      showDialog('è¯­è¨€è®¾ç½®', `å·²åˆ‡æ¢åˆ°ï¼š${selectedText}`);
    }

    // åˆå§‹åŒ–è®¾ç½®é¢æ¿äº‹ä»¶ç›‘å¬å™¨
    function initSettingsEvents() {
      // åŠ è½½ä¿å­˜çš„è®¾ç½®
      loadSettingsFromStorage();
      
      // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­è®¾ç½®é¢æ¿
      document.addEventListener('click', function(e) {
        const settingsModal = document.getElementById('settingsModal');
        if (e.target === settingsModal) {
          closeSettings();
        }
      });
    }
    
    // ä»æœ¬åœ°å­˜å‚¨åŠ è½½è®¾ç½®
    function loadSettingsFromStorage() {
      // åŠ è½½ä¸»é¢˜è®¾ç½®
      const savedTheme = localStorage.getItem('theme') || 'light';
      const themeBtn = document.querySelector(`[onclick="selectTheme('${savedTheme}')"]`);
      if (themeBtn) {
        themeBtn.classList.add('active');
      }
      
      // åŠ è½½è¯­è¨€è®¾ç½®
      const savedLanguage = localStorage.getItem('language') || 'zh';
      const languageSelect = document.getElementById('languageSelect');
      if (languageSelect) {
        languageSelect.value = savedLanguage;
      }
      
      // åŠ è½½å¼€å…³è®¾ç½®
      const switches = ['soundToggle', 'vibrationToggle', 'notificationToggle'];
      switches.forEach(switchId => {
        const toggle = document.getElementById(switchId);
        if (toggle) {
          const savedState = localStorage.getItem(switchId);
          toggle.checked = savedState === 'true';
        }
      });
    }
    
    // æ›´æ–°ä¸ªäººèµ„æ–™æ˜¾ç¤º
    function updateProfileDisplay() {
      const userEmail = localStorage.getItem('userEmail') || 'user@example.com';
      const profileEmail = document.getElementById('profileEmail');
      if (profileEmail) {
        profileEmail.textContent = userEmail;
      }
      
      // å¯ä»¥æ·»åŠ æ›´å¤šä¸ªäººä¿¡æ¯çš„æ›´æ–°é€»è¾‘
    }

    window.onload = init;
  </script>
  <script src="js/global-background.js"></script>
</body>
</html>